# Development

## Prepare

1. 申请gitlab 账号， 地址
2. 联系陈牵，将账号加入群组 xxxx
3. 配置sshkey 到gitlab中
4. 至此完成加入项目的操作

## Setup

拉取最新源码

```
git clone ssh://git@10.142.55.199:10022/basinspace/bidspy.git
```

进入项目

```
cd bidspy
```

配置开发环境（环境变量等）

```
sh setup_dev.sh
```



私有仓库默认为环境变量控制

```
export PRIVATE_REGISTRY=10.142.55.199:5006
```

```
echo "export PRIVATE_REGISTRY=10.142.55.199:5006" >> ~/.bashrc
```

每次更新环境变量必须 \(无法通过脚本完成，必须在终端执行source\)

```
source ~/.bashrc
```



## Project Structure

* config : 部署时， 各个模块使用的配置文件
* data : 部署后，需要导入的数据 \(有些依赖需要从外部地址拉取\)
* dist ： build 输出目录
* extractor : 招标公告抽取服务
* pipeline ：数据存储处理服务
* publisher : 订阅服务
* registry : docker 仓库
* spider : 爬虫服务 \(包含 basin-spider 和 udb-spider\)
* script : 部署相关的脚本
* build.sh : 构建入口
* setup\_develop.sh : 开发环境搭建
* test.sh : 测试入口

项目默认端口

* udb-spider 5000
* basin-spider 5001
* pipeline 7000
* repository 6000
* extractor : 12000

## 开发注意事项

##### gitlab 规范

branch：

* dev:
* master: 

##### 镜像列表

* python:2
* jfloff/alpine-python:2.7
* python:2.7-alpine
* redis:3.2.11
* mongo:3.0.15
* centos:7.4.1708

需要使用其他基础镜像需要通报， 最终更新到 bidspy/   基础镜像列表文件

