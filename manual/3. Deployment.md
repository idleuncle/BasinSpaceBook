# Deploy

## Requirement

部署机必须具备:

1. docker >= 1.12 环境

可选(ansible安装):
1. python 2.7
2. ansible>2.4

--------

## Private Docker Registry

### 环境变量

私有仓库默认由环境变量控制

```
export PRIVATE_REGISTRY=10.142.55.199:5006
```

bash 的环境变量设置方式为(具体要根据使用的shell)

```
echo "export PRIVATE_REGISTRY=10.142.55.199:5006" >> ~/.bashrc
```

每次更新环境变量必须 \(无法通过脚本完成，必须在终端执行source\)

```
source ~/.bashrc
```

### Docker服务配置

For linux:

```
mkdir -p /etc/docker
echo '{"registry-mirrors": ["http://'${PRIVATE_REGISTRY}'"], "insecure-registries" : [ "'${PRIVATE_REGISTRY}'"] }' > /etc/docker/daemon.json
```

For Mac:

在 docker 的insecure-registries设置部分加上 ${PRIVATE_REGISTRY}