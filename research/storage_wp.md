# 发现问题
docker 容器默认模式不保存数据,销毁及删除数据.
对于需要保存数据的容器,主要有几种方式:

1. 数据卷:
    -v 数据挂载到宿主机,但数据存储在该宿主机中,迁移困难
    
1. 包含数据的容器:
    -v 容器挂载数据,作为数据载体,提供其他容器访问 --volumes-from
    
缺点同上.数据存储于宿主机中,迁移困难

以上方式由于数据保存在宿主机中,数据不共享,迁移困难


# 解决方案

容器持久化,主要有几种特性:
+ 用户无需指定存储类型
+ 部署一个多容器应用至多台主机
+ 在两个主机间迁移容器
+ 当容器主机发生改变时支持附上和分离数据卷
+ 支持迁移服务器之间的本地数据卷


解决容器持久化的宿主机数据共享,方便数据迁移,提出以下几种方式:

1. 存储后端是共享存储:
    -v 容器挂载Nas等共享存储上,由共享存储来维护数据
    优点:主机失效,容器数据不丢失
    缺点:价格好像较贵.

2. 分布式容器存储
主流有:
    1. flocker
        ![](/assets/Snip20171206_1.png)
    2. portworx
        ![](/assets/Snip20171206_3.png)
    3. Rex-ray(暂时没研究)



# 验证模型
1. 本地数据卷存储,容器所在宿主机出现故障.重新部署新宿主机,数据不受影响.
2. 数据的迁移.对性能影响,例如:数据库性能.

针对以上模型做flocker和portworx进行验证.
![](/assets/storage.png)



# 总结
还在测试flocker和portworx使用方式.暂无结论.


